{
    "version": "https://jsonfeed.org/version/1",
    "title": "Walt's Blog • All posts by \"工具\" tag",
    "description": "",
    "home_page_url": "http://waltcsz.github.io",
    "items": [
        {
            "id": "http://waltcsz.github.io/2023/07/pwn%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7%E5%8F%8A%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/",
            "url": "http://waltcsz.github.io/2023/07/pwn%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7%E5%8F%8A%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/",
            "title": "pwn常用工具及环境配置",
            "date_published": "2023-07-19T14:59:36.000Z",
            "content_html": "<h1 id=\"环境\"><a class=\"markdownIt-Anchor\" href=\"#环境\">#</a> 环境</h1>\n<h2 id=\"python\"><a class=\"markdownIt-Anchor\" href=\"#python\">#</a> python</h2>\n<h3 id=\"str和bytes转换\"><a class=\"markdownIt-Anchor\" href=\"#str和bytes转换\">#</a> str 和 bytes 转换</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>B <span class=\"token operator\">=</span> S<span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token string\">'utf-8'</span><span class=\"token punctuation\">)</span>\t<span class=\"token comment\">#可忽略参数</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>S <span class=\"token operator\">=</span> B<span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token string\">'utf-8'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>B <span class=\"token operator\">=</span> <span class=\"token builtin\">bytes</span><span class=\"token punctuation\">(</span>S<span class=\"token punctuation\">,</span><span class=\"token string\">'utf-8'</span><span class=\"token punctuation\">)</span>\t<span class=\"token comment\">#不可忽略参数</span></pre></td></tr></table></figure><h3 id=\"字符串替换\"><a class=\"markdownIt-Anchor\" href=\"#字符串替换\">#</a> 字符串替换</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>dynstr <span class=\"token operator\">=</span> dynstr<span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">\"read\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"system\"</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h2 id=\"checksec\"><a class=\"markdownIt-Anchor\" href=\"#checksec\">#</a> checksec</h2>\n<ul>\n<li>RELRO got 表写权限 Partial RELRO 代表具有写权限</li>\n<li>stack canary 栈溢出保护</li>\n<li>NX：No-eXecute 不可执行保护</li>\n<li>PIE（ASLR）内存地址随机化 代码地址前几位随机 后几位固定</li>\n</ul>\n<h2 id=\"pwntools\"><a class=\"markdownIt-Anchor\" href=\"#pwntools\">#</a> PWNtools</h2>\n<h3 id=\"常用命令\"><a class=\"markdownIt-Anchor\" href=\"#常用命令\">#</a> 常用命令</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>context<span class=\"token punctuation\">(</span>log_level<span class=\"token operator\">=</span><span class=\"token string\">'debug'</span><span class=\"token punctuation\">)</span>\t\t<span class=\"token comment\">#python 调试</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>gdb<span class=\"token punctuation\">.</span>attach<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">,</span> <span class=\"token string\">'b *0x080323'</span><span class=\"token punctuation\">)</span>\t<span class=\"token comment\">#gdb 动态调试</span></pre></td></tr></table></figure><h3 id=\"elf\"><a class=\"markdownIt-Anchor\" href=\"#elf\">#</a> elf</h3>\n<p>当拥有 libc 文件时，利用 ret2libc 寻找 /bin/sh 字符串</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>libc<span class=\"token operator\">=</span>ELF<span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>libc<span class=\"token punctuation\">.</span>so<span class=\"token punctuation\">.</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>binsh <span class=\"token operator\">=</span> libcbase <span class=\"token operator\">+</span> <span class=\"token builtin\">next</span><span class=\"token punctuation\">(</span>libc<span class=\"token punctuation\">.</span>search<span class=\"token punctuation\">(</span><span class=\"token string\">b'/bin/sh'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>获取.dynstr 段的数据</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>dynstr <span class=\"token operator\">=</span> elf<span class=\"token punctuation\">.</span>get_section_by_name<span class=\"token punctuation\">(</span><span class=\"token string\">'.dynstr'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"libcsearcher\"><a class=\"markdownIt-Anchor\" href=\"#libcsearcher\">#</a> LibcSearcher</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> LibcSearcher <span class=\"token keyword\">import</span> LibcSearcher</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">#获取__libc_start_main 的真实地址储存至 lsm_a</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>libc <span class=\"token operator\">=</span> LibcSearcher<span class=\"token punctuation\">(</span><span class=\"token string\">'__libc_start_main'</span><span class=\"token punctuation\">,</span>lsm_a<span class=\"token punctuation\">)</span>\t<span class=\"token comment\">#参数 1 为字符串，函数名，参数 2 为地址</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>libcbase <span class=\"token operator\">=</span> lsm_a <span class=\"token operator\">-</span> libc<span class=\"token punctuation\">.</span>dump<span class=\"token punctuation\">(</span><span class=\"token string\">'__libc_start_main'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>sys_a <span class=\"token operator\">=</span> libcbase <span class=\"token operator\">+</span> libc<span class=\"token punctuation\">.</span>dump<span class=\"token punctuation\">(</span><span class=\"token string\">'system'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>bs_a <span class=\"token operator\">=</span> libcbase <span class=\"token operator\">+</span> libc<span class=\"token punctuation\">.</span>dump<span class=\"token punctuation\">(</span><span class=\"token string\">'str_bin_sh'</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"rop\"><a class=\"markdownIt-Anchor\" href=\"#rop\">#</a> ROP</h3>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzU0MjE4ODMzL2FydGljbGUvZGV0YWlscy8xMzA0MjY0MDQ=\">详细的资料</span></p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>rop<span class=\"token operator\">=</span>ROP<span class=\"token punctuation\">(</span><span class=\"token string\">'./pwn'</span><span class=\"token punctuation\">,</span>base<span class=\"token operator\">=</span><span class=\"token number\">0x400000</span><span class=\"token punctuation\">,</span>badchars<span class=\"token operator\">=</span><span class=\"token string\">b'\\n'</span><span class=\"token punctuation\">)</span>\t<span class=\"token comment\">#一般只需第一个参数</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>rop<span class=\"token punctuation\">.</span>chain<span class=\"token punctuation\">(</span>base<span class=\"token punctuation\">:</span> <span class=\"token builtin\">int</span><span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span>\t\t\t\t\t\t<span class=\"token comment\">#返回 bytes 数据</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>rop<span class=\"token punctuation\">.</span>call<span class=\"token punctuation\">(</span>resolvable<span class=\"token punctuation\">,</span> arguments<span class=\"token punctuation\">:</span> <span class=\"token builtin\">list</span><span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\t\t<span class=\"token comment\">#加入某函数调用</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>rop<span class=\"token punctuation\">.</span>raw<span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span>\t\t\t\t\t\t\t\t\t<span class=\"token comment\">#直接填充一个值</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>rop<span class=\"token punctuation\">.</span>dump<span class=\"token punctuation\">(</span>base<span class=\"token punctuation\">:</span> <span class=\"token builtin\">int</span><span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span>\t\t\t\t\t\t<span class=\"token comment\">#用好看的方式打印构造后</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>rop<span class=\"token punctuation\">.</span>migrate<span class=\"token punctuation\">(</span>next_base<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>rop<span class=\"token punctuation\">.</span>resolve<span class=\"token punctuation\">(</span>resolvable<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>rop<span class=\"token punctuation\">.</span>ret2csu<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> edi<span class=\"token operator\">=</span>Padding<span class=\"token punctuation\">(</span>‘edi’<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> rsi<span class=\"token operator\">=</span>Padding<span class=\"token punctuation\">(</span>‘rsi’<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> rdx<span class=\"token operator\">=</span>Padding<span class=\"token punctuation\">(</span>‘rdx’<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> rbx<span class=\"token operator\">=</span>Padding<span class=\"token punctuation\">(</span>‘rbx’<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> rbp<span class=\"token operator\">=</span>Padding<span class=\"token punctuation\">(</span>‘rbp’<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> r12<span class=\"token operator\">=</span>Padding<span class=\"token punctuation\">(</span>‘r12’<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> r13<span class=\"token operator\">=</span>Padding<span class=\"token punctuation\">(</span>‘r13’<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> r14<span class=\"token operator\">=</span>Padding<span class=\"token punctuation\">(</span>‘r14’<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> r15<span class=\"token operator\">=</span>Padding<span class=\"token punctuation\">(</span>‘r15’<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> call<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>rop <span class=\"token operator\">=</span> ROP<span class=\"token punctuation\">(</span><span class=\"token string\">\"./main_no_relro_64\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>rop<span class=\"token punctuation\">.</span>call<span class=\"token punctuation\">(</span><span class=\"token string\">'read'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> bss_base<span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>rop<span class=\"token punctuation\">.</span>raw<span class=\"token punctuation\">(</span>csu<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">,</span>elf<span class=\"token punctuation\">.</span>got<span class=\"token punctuation\">[</span><span class=\"token string\">'read'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x600988</span><span class=\"token operator\">+</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>rop<span class=\"token punctuation\">.</span>raw<span class=\"token punctuation\">(</span><span class=\"token number\">0x0000000000400771</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>rop<span class=\"token punctuation\">.</span>chain<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>rop<span class=\"token punctuation\">.</span>raw<span class=\"token punctuation\">(</span><span class=\"token string\">'a'</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>stack_size<span class=\"token operator\">-</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>rop<span class=\"token punctuation\">.</span>chain<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>io<span class=\"token punctuation\">.</span>send<span class=\"token punctuation\">(</span>rop<span class=\"token punctuation\">.</span>chain<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h2 id=\"gdb\"><a class=\"markdownIt-Anchor\" href=\"#gdb\">#</a> GDB</h2>\n<ul>\n<li>\n<p>l</p>\n</li>\n<li>\n<p>b *0x999</p>\n<p>b func</p>\n<p>断点</p>\n</li>\n<li>\n<p>p func</p>\n<p>print 打印变量内容</p>\n</li>\n<li>\n<p>x /80wg 0x9323454</p>\n<p>读取内存内容 单位数 字节 单位字节数</p>\n</li>\n<li>\n<p>vmmap</p>\n</li>\n</ul>\n<h3 id=\"objdump\"><a class=\"markdownIt-Anchor\" href=\"#objdump\">#</a> objdump</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>objdump <span class=\"token parameter variable\">-d</span> <span class=\"token parameter variable\">-j</span> .plt pwn\t<span class=\"token comment\">#查看.plt 表</span></pre></td></tr></table></figure>",
            "tags": [
                "工具"
            ]
        }
    ]
}