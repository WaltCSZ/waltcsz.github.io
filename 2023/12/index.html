<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"/><meta name="theme-color" content="#222"/><meta http-equiv="X-UA-COMPATIBLE" content="IE=edge,chrome=1"/><meta name="renderer" content="webkit"/><link rel="icon" type="image/ico" sizes="32x32" href="/assets/favicon.ico"/><link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png"/><link rel="alternate" href="/rss.xml" title="Walt's Blog" type="application/rss+xml"><link rel="alternate" href="/atom.xml" title="Walt's Blog" type="application/atom+xml"><link rel="alternate" type="application/json" title="Walt's Blog" href="http://waltcsz.github.io/feed.json"/><link rel="preconnect" href="https://lf9-cdn-tos.bytecdntp.com"/><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"/><link rel="dns-prefetch" href="https://unpkg.com"/><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.3.6"><script src="https://cdn.staticfile.org/vue/3.2.45/vue.global.prod.js"></script><link rel="canonical" href="http://waltcsz.github.io/2023/12/"><title></title><meta name="generator" content="Hexo 6.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline"></h1><div class="meta"><span class="item" title="创建时间：2023-12-05 21:34:54"><span class="icon"><i class="ic i-calendar"></i></span><span class="text">发表于</span><time itemprop="dateCreated datePublished" datetime="2023-12-05T21:34:54+08:00">2023-12-05</time></span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i></span><span class="text">本文字数</span><span>17k</span><span class="text">字</span></span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i></span><span class="text">阅读时长</span><span>16 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span><span class="line"></span><span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">BLOG</a></li></ul><ul class="right" id="rightNav"><li class="item theme" @click="changeThemeByBtn"><i class="ic" :class="{'i-sun': !themeStatus,'i-moon': themeStatus}"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div class="pjax" id="imgs"><ul><li class="item" data-background-image="https://tva2.sinaimg.cn/large/6833939bly1giciryrr3rj20zk0m8nhk.jpg"></li><li class="item" data-background-image="https://tva2.sinaimg.cn/large/6833939bly1gicis081o9j20zk0m8dmr.jpg"></li><li class="item" data-background-image="https://tva2.sinaimg.cn/large/6833939bly1giciszlczyj20zk0m816d.jpg"></li><li class="item" data-background-image="https://tva2.sinaimg.cn/large/6833939bly1gicis3attqj20zk0m8k7l.jpg"></li><li class="item" data-background-image="https://tva2.sinaimg.cn/large/6833939bly1gicitcxhpij20zk0m8hdt.jpg"></li><li class="item" data-background-image="https://tva2.sinaimg.cn/large/6833939bly1gicit31ffoj20zk0m8naf.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"></path></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"></use><use xlink:href="#gentle-wave" x="48" y="3"></use><use xlink:href="#gentle-wave" x="48" y="5"></use><use xlink:href="#gentle-wave" x="48" y="7"></use></g></svg></div><main><div class="inner"><div class="pjax" id="main"><div class="article wrap"><div class="breadcrumb" itemListElement itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i><span><a href="/">首页</a></span></div><article class="post block" itemscope="itemscope" itemtype="http://schema.org/Article" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://waltcsz.github.io/2023/12/"/><span hidden="hidden" itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="image" content="/assets/avatar.jpg"/><meta itemprop="name" content="Walt CSZ"/><meta itemprop="description" content=", "/></span><span hidden="hidden" itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="Walt's Blog"/></span><div class="body md" itemprop="articleBody"><h1 id="ctf中rsa套路"><a class="markdownIt-Anchor" href="#ctf中rsa套路">#</a> CTF 中 RSA 套路</h1>
<p>以前一直用的是<span class="exturl" data-url="aHR0cDovL2JvYmFvLjM2MC5jbi9sZWFybmluZy9kZXRhaWwvMzA1OC5odG1sJUU4JUJGJTk5JUU5JTg3JThDJUU3JTlBJTg0JUVGJUJDJThDJUU1JThGJUFGJUU2JTk4JUFGJUU1JThGJTkxJUU3JThFJUIwJUU4JUJGJTk5JUU5JTg3JThDJUU5JTlEJUEyJUU1JUE1JUJEJUU0JUI5JTg1JUU2JUIyJUExJUU2JTlCJUI0JUU2JTk2JUIwJUU0JUJBJTg2JUVGJUJDJThDJUU2JTgzJUIzJUU0JUJBJTg2JUU2JTgzJUIzJUU4JUJGJTk4JUU2JTk4JUFGJUU4JTg3JUFBJUU1JUI3JUIxJUU1JTlDJUE4JUU2JTk1JUI0JUU3JTkwJTg2JUU0JUI4JTgwJUU0JUI4JThCJUU1JTkwJUE3JUUzJTgwJTgy"> http://bobao.360.cn/learning/detail/3058.html 这里的，可是发现这里面好久没更新了，想了想还是自己在整理一下吧。</span></p>
<p>具体 RSA 加解密算法就不介绍了，先看数据提取吧。</p>
<p><strong>需要注意的是，代码中很多地方用到了 gmpy2 库，安装方法参考<span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vcGNhdC9wLzU3NDY4MjEuaHRtbA=="> https://www.cnblogs.com/pcat/p/5746821.html</span></strong></p>
<h2 id="数据提取"><a class="markdownIt-Anchor" href="#数据提取">#</a> 数据提取</h2>
<p>一般来说，RSA 基本围绕着 c,m,e,d,p,q,n 这几个参数展开，但是题目一般不会直接给参数，需要我们自己手工提取。</p>
<ul>
<li>
<p>pem 文件：针对这类文件可以直接使用 openssl 提取，大概使用过的方式有：</p>
<pre><code>openssl   rsautl -encrypt -in FLAG -inkey public.pem -pubin -out flag.enc
openssl   rsa -pubin -text -modulus -in warmup -in public.pem
</code></pre>
</li>
<li>
<p>pcap 文件：针对这类文件可以使用 wireshake follow 一下。这种问题一般都是写了一个交互式 crypto 系统，可能产生多轮交互</p>
</li>
<li>
<p>ppc 模式：这种模式是上述 pcap 文件的交互版，会给一个端口进行一些 crypto 的交互，参数会在交互中给出。</p>
</li>
</ul>
<h2 id="模数分解"><a class="markdownIt-Anchor" href="#模数分解">#</a> 模数分解</h2>
<h1 id="已知epq求d"><a class="markdownIt-Anchor" href="#已知epq求d">#</a> 已知 e,p,q 求 d</h1>
<pre><code>d = gmpy2.invert(e, (p-1)*(q-1))
</code></pre>
<h1 id="已知edn求pq"><a class="markdownIt-Anchor" href="#已知edn求pq">#</a> 已知 e,d,n 求 p,q</h1>
<pre><code>import random  
  
def gcd(a, b):  
   if a &lt; b:  
     a, b = b, a  
   while b != 0:  
     temp = a % b  
     a = b  
     b = temp  
   return a  
  
def getpq(n,e,d):  
    p = 1  
    q = 1  
    while p==1 and q==1:  
        k = d * e - 1  
        g = random.randint ( 0 , n )  
        while p==1 and q==1 and k % 2 == 0:  
            k /= 2  
            y = pow(g,k,n)  
            if y!=1 and gcd(y-1,n)&gt;1:  
                p = gcd(y-1,n)  
                q = n/p  
    return p,q  
  
def main():  
 
    n = 0xa66791dc6988168de7ab77419bb7fb0c001c62710270075142942e19a8d8c51d053b3e3782a1de5dc5af4ebe99468170114a1dfe67cdc9a9af55d655620bbab  
    e =  0x10001
    d =  0x123c5b61ba36edb1d3679904199a89ea80c09b9122e1400c09adcf7784676d01d23356a7d44d6bd8bd50e94bfc723fa87d8862b75177691c11d757692df8881

    p,q = getpq(n,e,d)  
    print &quot;p: &quot;+hex(p)
    print &quot;q: &quot;+hex(q)  
  
if __name__ == '__main__':  
    main()
</code></pre>
<h1 id="在线分解n"><a class="markdownIt-Anchor" href="#在线分解n">#</a> 在线分解 n</h1>
<p><span class="exturl" data-url="aHR0cDovL2ZhY3RvcmRiLmNvbS8=">http://factordb.com</span><br>
 通过在此类网站上查询 n，如果可以分解或者之前分解成功过，那么可以直接得到 p 和 q</p>
<h1 id="yafu分解n"><a class="markdownIt-Anchor" href="#yafu分解n">#</a> yafu 分解 n</h1>
<p><img data-src="https://i.imgur.com/dVDqGFL.png" alt="img"><br>
 直接打开程序，然后输入 factor (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo stretchy="false">)</mo><mtext>，</mtext><mi mathvariant="normal">‘</mi></mrow><annotation encoding="application/x-tex">n)，`</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mord cjk_fallback">，</span><span class="mord">‘</span></span></span></span>n` 为模数，此方法比上面的在线要好用很多</p>
<h1 id="公约数分解n"><a class="markdownIt-Anchor" href="#公约数分解n">#</a> 公约数分解 n</h1>
<p>识别此类题目，通常会发现题目给了多个 n，均不相同，并且都是 2048bit，4096bit 级别，无法正面硬杠，并且明文都没什么联系，e 也一般取 65537。可以直接 <code>gcd(n1,n2)</code>  求出一个因数。如下:</p>
<pre><code>n1=9051013965404084482870087864821455535159008696042953021965631089095795348830954383127323853272528967729311045179605407693592665683311660581204886571146327720288455874927281128121117323579691204792399913106627543274457036172455814805715668293705603675386878220947722186914112990452722174363713630297685159669328951520891938403452797650685849523658191947411429068829734053745180460758604283051344339641429819373112365211739216160420494167071996438506850526168389386850499796102003625404245645796271690310748804327
n2=13225948396179603816062046418717214792668512413625091569997524364243995991961018894150059207824093837420451375240550310050209398964506318518991620142575926623780411532257230701985821629425722030608722035570690474171259238153947095310303522831971664666067542649034461621725656234869005501293423975184701929729170077280251436216167293058560030089006140224375425679571181787206982712477261432579537981278055755344573767076951793312062480275004564657590263719816033564139497109942073701755011873153205366238585665743
</code></pre>
<p>可以直接用公约数分解 n，求得 p,q</p>
<pre><code>def gcd(a, b):
   if a &lt; b:
     a, b = b, a
   while b != 0:
     temp = a % b
     a = b
     b = temp
   return a

n1=9051013965404084482870087864821455535159008696042953021965631089095795348830954383127323853272528967729311045179605407693592665683311660581204886571146327720288455874927281128121117323579691204792399913106627543274457036172455814805715668293705603675386878220947722186914112990452722174363713630297685159669328951520891938403452797650685849523658191947411429068829734053745180460758604283051344339641429819373112365211739216160420494167071996438506850526168389386850499796102003625404245645796271690310748804327
n2=13225948396179603816062046418717214792668512413625091569997524364243995991961018894150059207824093837420451375240550310050209398964506318518991620142575926623780411532257230701985821629425722030608722035570690474171259238153947095310303522831971664666067542649034461621725656234869005501293423975184701929729170077280251436216167293058560030089006140224375425679571181787206982712477261432579537981278055755344573767076951793312062480275004564657590263719816033564139497109942073701755011873153205366238585665743
print &quot;p: &quot;+str(gcd(n1,n2))
print &quot;q1: &quot;+str(n1/gcd(n1,n2))
print &quot;q2: &quot;+str(n2/gcd(n1,n2))
</code></pre>
<h2 id="低加密指数攻击"><a class="markdownIt-Anchor" href="#低加密指数攻击">#</a> 低加密指数攻击</h2>
<h1 id="e3时的小明文攻击"><a class="markdownIt-Anchor" href="#e3时的小明文攻击">#</a> e=3 时的小明文攻击</h1>
<p>当 e=3 时，如果明文过小，导致明文的三次方仍然小于 n，那么通过直接对密文三次开方，即可得到明文。如果明文的三次方虽然比 n 大，但是大不了多少，则可以爆破。如下代码:</p>
<pre><code>i=0
   while 1:
   if(gmpy2.root(c+i*N, 3)[1]==1):
     print gmpy2.root(c+i*N, 3)
     break
   i=i+1
</code></pre>
<h1 id="低加密指数广播攻击"><a class="markdownIt-Anchor" href="#低加密指数广播攻击">#</a> 低加密指数广播攻击</h1>
<p>如果选取的加密指数较低，并且使用了相同的加密指数给一个接受者的群发送相同的信息，那么可以进行广播攻击得到明文。<br>
这个识别起来比较简单，一般来说都是给了三组加密的参数和明密文，其中题目很明确地能告诉你这三组的明文都是一样的，并且 e 都取了一个较小的数字。<br>
<img data-src="https://i.imgur.com/H7Zec1s.png" alt="img"></p>
<h2 id="低解密指数攻击"><a class="markdownIt-Anchor" href="#低解密指数攻击">#</a> 低解密指数攻击</h2>
<p>识别：e 看起来特别大就行了<br>
 github 上有开源的攻击代码<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3BhYmxvY2VsYXllcy9yc2Etd2llbmVyLWF0dGFjaw=="> https://github.com/pablocelayes/rsa-wiener-attack</span><br>
 这里注意一个细节问题，如果在运行脚本的时候报错，请在脚本前加上：</p>
<pre><code>import   sys
sys.setrecursionlimit(10000000)
</code></pre>
<p>题目：</p>
<pre><code>Bob is extremely paranoid, so he decided that just one RSA encryption is not enough. Before sending his message to Alice, he forced her to create 5 public keys so he could encrypt his message 5 times! Show him that he still is not secure.


Here are the 5 public keys that Bob used, each in the format of (N, e):
(9247606623523847772698953161616455664821867183571218056970099751301682205123115716089486799837447397925308887976775994817175994945760278197527909621793469, 11)
(9247606623523847772698953161616455664821867183571218056970099751301682205123115716089486799837447397925308887976775994817175994945760278197527909621793469, 41)
(9247606623523847772698953161616455664821867183571218056970099751301682205123115716089486799837447397925308887976775994817175994945760278197527909621793469, 67623079903)
(9247606623523847772698953161616455664821867183571218056970099751301682205123115716089486799837447397925308887976775994817175994945760278197527909621793469, 5161910578063)
(9247606623523847772698953161616455664821867183571218056970099751301682205123115716089486799837447397925308887976775994817175994945760278197527909621793469, 175238643578591220695210061216092361657427152135258210375005373467710731238260448371371798471959129039441888531548193154205671)

Here is his encrypted message:
7117565509436551004326380884878672285722722211683863300406979545670706419248965442464045826652880670654603049188012705474321735863639519103720255725251120
</code></pre>
<p>根据题意，用一样的 n 不同的 e 来加密 5 次，其实效果和用 5 个 e 的乘积加密一次是一样的。其实如果 5 个 e 的乘积来加密的话，e 很大的话就可以用低解密指数攻击来了。</p>
<pre><code>import ContinuedFractions, Arithmetic, RSAvulnerableKeyGenerator


def hack_RSA(e,n):
    '''
    Finds d knowing (e,n)
    applying the Wiener continued fraction attack
    '''
    frac = ContinuedFractions.rational_to_contfrac(e, n)
    convergents = ContinuedFractions.convergents_from_contfrac(frac)
    
    for (k,d) in convergents:
        
        #check if d is actually the key
        if k!=0 and (e*d-1)%k == 0:
            phi = (e*d-1)//k
            s = n - phi + 1
            # check if the equation x^2 - s*x + n = 0
            # has integer roots
            discr = s*s - 4*n
            if(discr&gt;=0):
                t = Arithmetic.is_perfect_square(discr)
                if t!=-1 and (s+t)%2==0:
                    print(&quot;Hacked!&quot;)
                    return d


(n1,e1)=(9247606623523847772698953161616455664821867183571218056970099751301682205123115716089486799837447397925308887976775994817175994945760278197527909621793469, 11)
(n2,e2)=(9247606623523847772698953161616455664821867183571218056970099751301682205123115716089486799837447397925308887976775994817175994945760278197527909621793469, 41)
(n3,e3)=(9247606623523847772698953161616455664821867183571218056970099751301682205123115716089486799837447397925308887976775994817175994945760278197527909621793469, 67623079903)
(n4,e4)=(9247606623523847772698953161616455664821867183571218056970099751301682205123115716089486799837447397925308887976775994817175994945760278197527909621793469, 5161910578063)
(n5,e5)=(9247606623523847772698953161616455664821867183571218056970099751301682205123115716089486799837447397925308887976775994817175994945760278197527909621793469, 175238643578591220695210061216092361657427152135258210375005373467710731238260448371371798471959129039441888531548193154205671)

c=7117565509436551004326380884878672285722722211683863300406979545670706419248965442464045826652880670654603049188012705474321735863639519103720255725251120
e=e1*e2*e3*e4*e5%n1
d=hack_RSA(e,n1)


m=pow(c,d,n1)
print '&#123;:x&#125;'.format(m).decode('hex')
</code></pre>
<p>运行的时候如果报 import 包不存在，那是因为没有把<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3BhYmxvY2VsYXllcy9yc2Etd2llbmVyLWF0dGFjayVFOSU4NyU4QyVFOSU5RCVBMiVFNiU4OSU4MCVFNiU5QyU4OSVFNyU5QSU4NHB5JUU2JTk2JTg3JUU0JUJCJUI2JUU2JTk0JUJFJUU1JTlDJUE4JUU1JTkwJThDJUU0JUI4JTgwJUU3JTlCJUFFJUU1JUJEJTk1JUU0JUI4JThCJUUzJTgwJTgy"> https://github.com/pablocelayes/rsa-wiener-attack 里面所有的 py 文件放在同一目录下。</span></p>
<h2 id="共模攻击"><a class="markdownIt-Anchor" href="#共模攻击">#</a> 共模攻击</h2>
<p>识别：若干次加密，e 不同，n 相同，m 相同。就可以在不分解 n 和求 d 的前提下，解出明文 m。<img data-src="https://i.imgur.com/w8UoOQ2.png" alt="img"><br>
 已知 e1,e2,n,c1,c2</p>
<pre><code>def egcd(a, b):
    if a == 0:
      return (b, 0, 1)
    else:
      g, y, x = egcd(b % a, a)
      return (g, x - (b // a) * y, y)
def modinv(a, m):
    g, x, y = egcd(a, m)
    if g != 1:
      raise Exception('modular inverse does not exist')
    else:
      return x % m

s = egcd(e1, e2)
s1 = s[1]
s2 = s[2]

if s1&lt;0:
   s1 = - s1
   c1 = modinv(c1, n)
elif s2&lt;0:
   s2 = - s2
   c2 = modinv(c2, n)
m=(pow(c1,s1,n)*pow(c2,s2,n)) % n
print '&#123;:x&#125;'.format(m).decode('hex')
</code></pre>
<h2 id="已知dpdq求解"><a class="markdownIt-Anchor" href="#已知dpdq求解">#</a> 已知 dp,dq 求解</h2>
<p>其实这种方法很简单，但是由于我当时做的时候查了好久 dp,dq 是什么，所以还是记录下来扫个坑吧。<br>
这种参数是为了让解密的时候更快速产生的，其中:</p>
<pre><code>dp=d%(p-1)
dq=d%(q-1)
</code></pre>
<p>解密全部代码如下:</p>
<pre><code>InvQ=gmpy2.invert(q,p)
mp=pow(c,dp,p)
mq=pow(c,dq,q)
m=(((mp-mq)*InvQ)%p)*q+mq
print '&#123;:x&#125;'.format(m).decode('hex')
</code></pre>
<h2 id="隐藏小私有指数δ的rsa后门密钥生成算法"><a class="markdownIt-Anchor" href="#隐藏小私有指数δ的rsa后门密钥生成算法">#</a> 隐藏小私有指数 δ 的 RSA 后门密钥生成算法</h2>
<p>以下题目来自于 hctf2016<br>
<span class="exturl" data-url="aHR0cDovLzB4NDgucHcvMjAxNi8xMS8yOC8weDI4Lw==">http://0x48.pw/2016/11/28/0x28/</span><br>
<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0hjYW1hZWwvY3RmLWxpYnJhcnkvdHJlZS9tYXN0ZXIvUlNBMQ==">https://github.com/Hcamael/ctf-library/tree/master/RSA1</span><br>
<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0hjYW1hZWwvY3RmLWxpYnJhcnkvYmxvYi9tYXN0ZXIvUlNBMS9yc2ExX3BheWxvYWQucHk=">https://github.com/Hcamael/ctf-library/blob/master/RSA1/rsa1_payload.py</span><br>
 算法原理如下：<br>
<img data-src="https://i.imgur.com/5thK6MI.png" alt="img"><br>
 攻击方法也很简单<br>
<img data-src="https://i.imgur.com/5UCVMXO.png" alt="img"></p>
<p>解题关键是在下图<br>
<img data-src="https://i.imgur.com/Om8Q7iX.png" alt="img"><br>
<img data-src="https://i.imgur.com/faCg1Q1.png" alt="img"><br>
 根据<strong> rsa-wiener-attack</strong> 我们可以知道，在 rsa 算法中，如果密钥 d 特别小，则我们可以根据 e,n 直接求出 d，所以上图满足条件。</p>
<p>而当我们求出了那两个东西 (原谅我打不出来…), 则和<strong>已知 e,d,n 求 p,q</strong> 的情况一样了，当 p,q 已知的时候就可以解出 d 了</p>
<h2 id="基于隐藏素数因子的rsa-hpβ算法高比特位已知分解"><a class="markdownIt-Anchor" href="#基于隐藏素数因子的rsa-hpβ算法高比特位已知分解">#</a> 基于隐藏素数因子的 RSA-HPβ 算法 (高比特位已知分解)</h2>
<p>以下题目来自于 hctf2016<br>
<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0hjYW1hZWwvY3RmLWxpYnJhcnkvdHJlZS9tYXN0ZXIvUlNBMg==">https://github.com/Hcamael/ctf-library/tree/master/RSA2</span><br>
payload:</p>
<pre><code>https://github.com/Hcamael/ctf-library/blob/master/RSA2/rsa2_payload.py
https://github.com/Hcamael/ctf-library/blob/master/RSA2/rsa2_payload.sage
</code></pre>
<p>该后门算法依赖于<strong> Coppersmith partial information attack</strong> 算法，sage 实现该算法，sage 安装详细看我的另一篇关于 sage 的安装。</p>
<p>Coppersmith partial information attack 算法可以理解成，当我们已知素数 p 或者 q 的前一定位数，可以根据这个算法还原完整的 p，q。<br>
算法实现代码：<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0dhby1DaHVhbi9SU0EtYW5kLUxMTC1hdHRhY2tz">https://github.com/Gao-Chuan/RSA-and-LLL-attacks</span></p>
<p>例题如下：<br>
<img data-src="https://i.imgur.com/P7UXiV6.png" alt="img"></p>
<p>仔细观察算法，n 是靠 t,u,r 来拼接成，而 u 是根据 p 的前 5k/16 位进行 des 转置得到的，所以<strong>当我们已知 n 的前提下，相当于我们已知 p 的前 5k/16 位</strong>。这就是我们利用的点。如下图：<br>
<img data-src="https://i.imgur.com/jtz02KN.png" alt="img"></p>
<p>利用代码如下:</p>
<pre><code>p4 = 0xf3a5f928e11c5901f9f4289e513f046748efb99d4f8e706e207a943e1d2c9df43feab38e20c2106d87167e5501ac41adfc4912732457103a4359e5b433da78f39ad6f206b8f170192aa0841feb501ce1
n = 0x7e7007c7c85788b9b77cda64c9b3f5d2a795fe1b1f8d3f120288a30a168c3ea932c7574700ff0f596c5ad04a703756aedc66b9b9e44911d55f0a72a1cc1a569cee02a84499cdb091b8471a8e6cc0ebca583dfd6fb8d5fecf32ff67d2ddeaaaaf9c71a10009b4218fc57743675f283d22734ac7ade2ca240772d11b5783755378f7c30988f41d4a9d62561ea6e5f2f21d3d44e8689e781d3f61356123929457d17b07a1d04741bf970afb590cd820dd12cf88f68b0e896388f433fd2adf3354353c9c56abb0cfea223387e6d0b2df10e450c621ac153e47369f888fdc0b39c842a5ddc6a11339862ccdb4be97a81445205fb8f8bde9daaad5d0dc2ea5bd3b8c43

//p的位数
pbits = 1024
//p未知的位数
kbits = pbits - p4.nbits()
print p4.nbits()
p4 = p4 &lt;&lt; kbits

PR.&lt;x&gt; = PolynomialRing(Zmod(n))

//f是原始的p
f = x + p4
x0 = f.small_roots(X=2^kbits, beta=0.4)[0]
print &quot;x: %s&quot; %hex(int(x0))

p = p4+x0
print &quot;p: &quot;, hex(int(p))
assert n % p == 0
q = n/int(p)

print &quot;q: &quot;, hex(int(q))
</code></pre>
<p><img data-src="https://i.imgur.com/Vwccm9g.png" alt="img"></p>
<h2 id="第二届强网杯_nextrsa_coppersmith"><a class="markdownIt-Anchor" href="#第二届强网杯_nextrsa_coppersmith">#</a> 第二届强网杯_nextrsa_Coppersmith</h2>
<p>题目描述是，加密指数 e=3，同时已知明文的高位，参数如下：</p>
<pre><code># n=0x79982a272b9f50b2c2bc8b862ccc617bb39720a6dc1a22dc909bbfd1243cc0a03dd406ec0b1a78fa75ce5234e8c57e0aab492050906364353b06ccd45f90b7818b04be4734eeb8e859ef92a306be105d32108a3165f96664ac1e00bba770f04627da05c3d7513f5882b2807746090cebbf74cd50c0128559a2cc9fa7d88f7b2d
# e=0x3
# c=0x381db081852c92d268b49a1b9486d724e4ecf49fc97dc5f20d1fad902b5cdfb49c8cc1e968e36f65ae9af7e8186f15ccdca798786669a3d2c9fe8767a7ae938a4f9115ae8fed4928d95ad550fddd3a9c1497785c9e2279edf43f04601980aa28b3b52afb55e2b34e5b175af25d5b3bd71db88b3b31e48a177a469116d957592c
# b=0xfedcba98765432100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# m=b+x (x:64bit)
</code></pre>
<p>其中不知道的就是 64 比特的 x，不过根据以下代码就可以算出 x：</p>
<pre><code>e = 0x3
b = b=0xfedcba98765432100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
n = 0x79982a272b9f50b2c2bc8b862ccc617bb39720a6dc1a22dc909bbfd1243cc0a03dd406ec0b1a78fa75ce5234e8c57e0aab492050906364353b06ccd45f90b7818b04be4734eeb8e859ef92a306be105d32108a3165f96664ac1e00bba770f04627da05c3d7513f5882b2807746090cebbf74cd50c0128559a2cc9fa7d88f7b2d
c=0x381db081852c92d268b49a1b9486d724e4ecf49fc97dc5f20d1fad902b5cdfb49c8cc1e968e36f65ae9af7e8186f15ccdca798786669a3d2c9fe8767a7ae938a4f9115ae8fed4928d95ad550fddd3a9c1497785c9e2279edf43f04601980aa28b3b52afb55e2b34e5b175af25d5b3bd71db88b3b31e48a177a469116d957592c

kbits=64
PR.&lt;x&gt; = PolynomialRing(Zmod(n))
f = (x + b)^e-c
x0 = f.small_roots(X=2^kbits, beta=1)[0]
print &quot;x: %s&quot; %hex(int(x0))
</code></pre>
<h2 id="强网杯_nextrsa_nextprime"><a class="markdownIt-Anchor" href="#强网杯_nextrsa_nextprime">#</a> 强网杯_nextrsa_nextprime</h2>
<p>参数如下：</p>
<pre><code># n=0x78e2e04bdc50ea0b297fe9228f825543f2ee0ed4c0ad94b6198b672c3b005408fd8330c36f55d36fb129d308c23e5cb8f4d61aa7b058c23607cef83d63c4ed0f066fc0b3c0062a2ac68c75ca8035b3bd7a320bdf29cfcf6cc30377743d2a8cc29f7c588b8043412366ab69ec824309cb1ef3851d4fb14a1f0a58e4a1193f5518fa1d0c159621e1f832b474182593db2352ef05101bf367865ad26efe14fce977e9e48d3310a18b67991958d1a01bd0f3276a669866f4deaef2a68bfaefd35fe2ba5023a22c32ae8b2979c26923ee3f855363f18d8d58bb1bc3b7f585c9d9f6618c727f0f7b9e6f32af2864a77402803011874ed2c65545ced72b183f5c55d4d1
# e=0x10001
# nextprime(p)*nextprime(q)=0x78e2e04bdc50ea0b297fe9228f825543f2ee0ed4c0ad94b6198b672c3b005408fd8330c36f55d36fb129d308c23e5cb8f4d61aa7b058c23607cef83d63c4ed0f066fc0b3c0062a2ac68c75ca8035b3bd7a320bdf29cfcf6cc30377743d2a8cc29f7c588b8043412366ab69ec824309cb1ef3851d4fb14a1f0a58e4a1193f5a58ee70a59ac06b64dbe04b876ff69436b78cf03371f2062707897bf4e580870e42b5e62709b69f6d4939ac5641ea0f29de44aaee8f2fcd0f66aaa720b584f7c801e52ce7cd41db45ceb99ebd7b51bef8d0cd2deb5c50b59f168276c9c98d46a1c37bd3d6ef81f2c6e89028680a172e00d92dd8b392135112dd16efab57d00b26b9
# c=0x1c3588ac81ec3d1b439cfd2d5e6e8a5a95c8f95aaeff1b0ba49276ade80435323f307a17006ae2ffb4ca321e54387d9b33ed7ccda3117f7bc8d247ffd2ccdd67b7e2aad3d908d0a5187a73d13d532c1cf41758e2743bd4359bf72a99bbf0d716bb171cf636bd56acee9551cbb8af25f32583facbd25aed232659d24580c5a30a080e2860790a65422f7c442559c3042d37fdd7e8c1dd604252a2cbff8c74e5a0b6a0dfb9dcfed9eed515705ab9214dcf2dabce7b354040940613d065918079b3197da948b6d1d7daccc417069f7102fd2525e879fe69b6d5fb39e1dd6c0a9a9087dcc809294d7774efb42829f6124dff4af44f308977d1f91422c63073176026
</code></pre>
<p>方法一：</p>
<pre><code>#!/usr/bin/env python
# -*- coding: utf-8 -*-
__Auther__ = 'M4x'


from gmpy2 import is_prime as prime
from gmpy2 import iroot

n = 15260473398916071686287752340249158279343013077145667794514717692352941873466690686288442204714585854869226872705293008837554012949598044297596015507031315006195230644722581744643756573982729344499452200116366327869178694692162014446578711956663348262932703160394101606708475725742890049311933691849747707673216322758418530420118502556719323543077771821163439824876751874675862075401986796272014746925015772045578403357300038192830197985871077621213669817380577176611560467051848951044963527185916781094981810804641387975398361694935093473717039550361644252381923994841138817152748279477868854093033234031994635408593
nn = 15260473398916071686287752340249158279343013077145667794514717692352941873466690686288442204714585854869226872705293008837554012949598044297596015507031315006195230644722581744643756573982729344499452200116366327869178694692162014446578711956663348262932703160394101606708475725742890049311933691849747707914818082716474881224336472709074679047145667796106895298086129057288449508218237679974321952279429832707229303594474494519945899481320231091983665654947081839784375373657345023890332691371443571370016623789041883821610353473726465037590414008198228956920913181526550775524028059426312173493877228564452496582329

#  print nn &gt; n
t = nn - n
f1 = lambda x, y: pow(x * y - t, 2) - 4 * n * x * y
f2 = lambda x, y, s: (t - x * y - s) / (2 * x)

for x in xrange(1, 3000):
    for y in xrange(1, 3000):
        print x, y
        if f1(x, y) &gt;= 0:
            s, b = iroot(f1(x, y), 2)
            if b:
                if prime(f2(x, y, int(s))):
                    print &quot;Success&quot;
                    print f2(x, y, int(s))
                    exit()
</code></pre>
<p>就是</p>
<pre><code>pq = n
(p + x)(q + y) = n'
-&gt; xy + py + qx = t(t = n' - n)

-&gt; xq^2^ + (xy - t)q + ny = 0

则该方程有素数接即可，可爆破x，y
</code></pre>
<p>方法二：<br>
因为 <code>n = p * q,nn = p1 * q1</code> <br>
 因为 n 和 nn 很相近，所以 n*nn 讲道理用 yafu 很快就能跑出来<br>
可以得到 <code>t1 = p*q1,t2 = q*p1 </code> <br>
然后 gcd 一下就可以了</p>
<p>[赏](javascript:void (0))</p>
<p><strong>本文标题:</strong><span class="exturl" data-url="aHR0cHM6Ly9lcnIwcnp6LmdpdGh1Yi5pby8yMDE3LzExLzE0L0NURiVFNCVCOCVBRFJTQSVFNSVBNSU5NyVFOCVCNyVBRi8=">CTF 中 RSA 套路</span></p>
<p><strong>文章作者:</strong><span class="exturl" data-url="aHR0cHM6Ly9lcnIwcnp6LmdpdGh1Yi5pby8=">Err0rzz</span></p>
<p>** 发布时间:**2017 年 11 月 14 日 - 19 时 16 分</p>
<p>** 最后更新:**2018 年 05 月 23 日 - 10 时 15 分</p>
<p><strong>原始链接:</strong><span class="exturl" data-url="aHR0cHM6Ly9lcnIwcnp6LmdpdGh1Yi5pby8yMDE3LzExLzE0L0NURiVFNCVCOCVBRFJTQSVFNSVBNSU5NyVFOCVCNyVBRi8=">http://Err0rzz.github.io/2017/11/14/CTF 中 RSA 套路 /</span></p>
<p><strong>许可协议:</strong> <span class="exturl" data-url="aHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbGljZW5zZXMvYnktbmMtc2EvMy4wL2NuLw==">“署名 - 非商用 - 相同方式共享 3.0”</span> 转载请保留原文链接及作者。</p>
</div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i></span><span class="text">更新于</span><time title="修改时间：2023-12-05 23:38:15" itemprop="dateModified" datetime="2023-12-05T23:38:15+08:00">2023-12-05</time></span></div><div class="reward"><button><i class="ic i-heartbeat"></i>赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/assets/wechatpay.png" alt="Walt CSZ 微信支付"/><p>微信支付</p></div><div><img data-src="/assets/alipay.png" alt="Walt CSZ 支付宝"/><p>支付宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者：</strong>Walt CSZ<i class="ic i-at"><em>@</em></i>Walt's Blog</li><li class="link"><strong>本文链接：</strong><a href="http://waltcsz.github.io/2023/12/" title="">http://waltcsz.github.io/2023/12/</a></li><li class="license"><strong>版权声明：</strong>本站所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2023/12/toolbox/" rel="prev" itemprop="url" data-background-image="https:&#x2F;&#x2F;tva2.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gicit31ffoj20zk0m8naf.jpg" title="toolBox"><span class="type">上一篇</span><h3>toolBox</h3></a></div><div class="item right"><a href="/2023/12/" rel="next" itemprop="url" data-background-image="https:&#x2F;&#x2F;tva2.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1giciszlczyj20zk0m816d.jpg" title="未命名"><span class="type">下一篇</span><h3>未命名</h3></a></div></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#ctf%E4%B8%ADrsa%E5%A5%97%E8%B7%AF"><span class="toc-number">1.</span> <span class="toc-text"> CTF 中 RSA 套路</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%8F%90%E5%8F%96"><span class="toc-number">1.1.</span> <span class="toc-text"> 数据提取</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E6%95%B0%E5%88%86%E8%A7%A3"><span class="toc-number">1.2.</span> <span class="toc-text"> 模数分解</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B7%B2%E7%9F%A5epq%E6%B1%82d"><span class="toc-number">2.</span> <span class="toc-text"> 已知 e,p,q 求 d</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B7%B2%E7%9F%A5edn%E6%B1%82pq"><span class="toc-number">3.</span> <span class="toc-text"> 已知 e,d,n 求 p,q</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9C%A8%E7%BA%BF%E5%88%86%E8%A7%A3n"><span class="toc-number">4.</span> <span class="toc-text"> 在线分解 n</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#yafu%E5%88%86%E8%A7%A3n"><span class="toc-number">5.</span> <span class="toc-text"> yafu 分解 n</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%AC%E7%BA%A6%E6%95%B0%E5%88%86%E8%A7%A3n"><span class="toc-number">6.</span> <span class="toc-text"> 公约数分解 n</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%8E%E5%8A%A0%E5%AF%86%E6%8C%87%E6%95%B0%E6%94%BB%E5%87%BB"><span class="toc-number">6.1.</span> <span class="toc-text"> 低加密指数攻击</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#e3%E6%97%B6%E7%9A%84%E5%B0%8F%E6%98%8E%E6%96%87%E6%94%BB%E5%87%BB"><span class="toc-number">7.</span> <span class="toc-text"> e&#x3D;3 时的小明文攻击</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BD%8E%E5%8A%A0%E5%AF%86%E6%8C%87%E6%95%B0%E5%B9%BF%E6%92%AD%E6%94%BB%E5%87%BB"><span class="toc-number">8.</span> <span class="toc-text"> 低加密指数广播攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%8E%E8%A7%A3%E5%AF%86%E6%8C%87%E6%95%B0%E6%94%BB%E5%87%BB"><span class="toc-number">8.1.</span> <span class="toc-text"> 低解密指数攻击</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB"><span class="toc-number">8.2.</span> <span class="toc-text"> 共模攻击</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B7%B2%E7%9F%A5dpdq%E6%B1%82%E8%A7%A3"><span class="toc-number">8.3.</span> <span class="toc-text"> 已知 dp,dq 求解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9A%90%E8%97%8F%E5%B0%8F%E7%A7%81%E6%9C%89%E6%8C%87%E6%95%B0%CE%B4%E7%9A%84rsa%E5%90%8E%E9%97%A8%E5%AF%86%E9%92%A5%E7%94%9F%E6%88%90%E7%AE%97%E6%B3%95"><span class="toc-number">8.4.</span> <span class="toc-text"> 隐藏小私有指数 δ 的 RSA 后门密钥生成算法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E9%9A%90%E8%97%8F%E7%B4%A0%E6%95%B0%E5%9B%A0%E5%AD%90%E7%9A%84rsa-hp%CE%B2%E7%AE%97%E6%B3%95%E9%AB%98%E6%AF%94%E7%89%B9%E4%BD%8D%E5%B7%B2%E7%9F%A5%E5%88%86%E8%A7%A3"><span class="toc-number">8.5.</span> <span class="toc-text"> 基于隐藏素数因子的 RSA-HPβ 算法 (高比特位已知分解)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E5%B1%8A%E5%BC%BA%E7%BD%91%E6%9D%AF_nextrsa_coppersmith"><span class="toc-number">8.6.</span> <span class="toc-text"> 第二届强网杯_nextrsa_Coppersmith</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%BA%E7%BD%91%E6%9D%AF_nextrsa_nextprime"><span class="toc-number">8.7.</span> <span class="toc-text"> 强网杯_nextrsa_nextprime</span></a></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Walt CSZ" data-src="/assets/avatar.jpg"/><p class="name" itemprop="name">Walt CSZ</p><div class="description" itemprop="description"></div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">48</span><span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">14</span><span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">35</span><span class="name">标签</span></a></div></nav><div class="social"><a href="https://github.com/waltcsz" class="item github" rel="noopener" title="https:&#x2F;&#x2F;github.com&#x2F;waltcsz" target="_blank"><i class="ic i-github"></i></a><a href="https://music.163.com/#/user/home?id=1352209376" class="item music" rel="noopener" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;1352209376" target="_blank"><i class="ic i-cloud-music"></i></a></div><div class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-user"></i>关于</a><ul class="submenu"><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于本站</a></li><li class="item"><a href="/admiration/" rel="section"><i class="ic i-coffee"></i>赞赏博主</a></li></ul></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>友链</a></li></div></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2023/12/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2023/12/toolbox/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/PWN/" title="分类于PWN">PWN</a><i class="ic i-angle-right"></i><a href="/categories/PWN/%E7%AC%94%E8%AE%B0/" title="分类于笔记">笔记</a></div><span><a href="/2023/11/inputanalyse/">inputAnalyse</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/PWN/" title="分类于PWN">PWN</a><i class="ic i-angle-right"></i><a href="/categories/PWN/%E7%AC%94%E8%AE%B0/" title="分类于笔记">笔记</a></div><span><a href="/2023/11/shellcode/">shellcode</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2023/12/">未命名</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/PWN/" title="分类于PWN">PWN</a><i class="ic i-angle-right"></i><a href="/categories/PWN/Write-Up/" title="分类于Write Up">Write Up</a></div><span><a href="/2023/10/newstarctf2023-week5/">newstarctf2023 week5</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2023/12/">未命名</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2023/11/http/">http</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2023/12/">未命名</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E7%AC%94%E8%AE%B0/" title="分类于笔记">笔记</a><i class="ic i-angle-right"></i><a href="/categories/%E7%AC%94%E8%AE%B0/Linux/" title="分类于Linux">Linux</a></div><span><a href="/2023/11/vim/">vim</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/PWN/" title="分类于PWN">PWN</a><i class="ic i-angle-right"></i><a href="/categories/PWN/Write-Up/" title="分类于Write Up">Write Up</a></div><span><a href="/2023/11/buu-1106/">buu 1106</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2023/12/">未命名</a></span></li></ul></div><div class="rpost pjax"><h2>最新评论</h2><ul class="leancloud-recent-comment" id="new-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2022 -<span itemprop="copyrightYear">2023</span><span class="with-love"><i class="ic i-sakura rotate"></i></span><span class="author" itemprop="copyrightHolder">Walt CSZ @ BLOG</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i></span><span title="站点总字数">378k 字</span><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="ic i-coffee"></i></span><span title="站点阅读时长">5:44</span></div><div class="powered-by">基于 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & Theme.<a href="https://github.com/theme-shoka-x/hexo-theme-shokaX/" rel="noopener" target="_blank">ShokaX</a></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL = {
        path: `2023/12//`,
        favicon: {
        show: `（●´3｀●）やれやれだぜ`,
        hide: `(´Д｀)大変だ！`
    },
    search: {
        placeholder: "文章搜索",
        empty: "关于 「 ${query} 」，什么也没搜到",
        stats: "${time} ms 内找到 ${hits} 条结果"
    },
    valine: true,
    chart: false,
    copy_tex: false,
    katex: false,
    mermaid: false,
    audio: undefined,
    fancybox: true,
    nocopy: false,
    outime: true,
    template: `<div class="note warning"><p><span class="label warning">文章时效性提示</span><br>这是一篇发布于 {{publish}} 天前，最后一次更新在 {{updated}} 天前的文章，部分信息可能已经发生改变，请注意甄别。</p></div>`,
    quiz: {
        choice: `单选题`,
        multiple: `多选题`,
        true_false: `判断题`,
        essay: `问答题`,
        gap_fill: `填空题`,
        mistake: `错题备注`
    },
    ignores: [
        (uri) => uri.includes('#'),
        (uri) => new RegExp(LOCAL.path + '$').test(uri),
            []
    ]
};
</script><script src="https://polyfill.io/v3/polyfill.min.js?features=default,fetch"></script><script src="https://lf9-cdn-tos.bytecdntp.com/cdn/expire-6-M/pace/1.0.2/pace.min.js"></script><script src="https://lf9-cdn-tos.bytecdntp.com/cdn/expire-6-M/algoliasearch/4.12.1/algoliasearch-lite.umd.min.js"></script><script src="https://lf9-cdn-tos.bytecdntp.com/cdn/expire-6-M/instantsearch.js/4.39.0/instantsearch.production.min.js"></script><script src="https://lf9-cdn-tos.bytecdntp.com/cdn/expire-6-M/quicklink/2.2.0/quicklink.umd.min.js"></script><script src="https://lf9-cdn-tos.bytecdntp.com/cdn/expire-6-M/??jquery/3.5.1/jquery.min.js,fancybox/3.5.7/jquery.fancybox.min.js,justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js" async></script><script src="https://lf9-cdn-tos.bytecdntp.com/cdn/expire-6-M/KaTeX/0.15.2/contrib/copy-tex.min.js" async></script><script src="/js/app.js?v=0.3.6"></script></body></html>